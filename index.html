<!doctype html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="nsa.png" width="100" type="image/x-icon">
  <title>nursAI - Platform Pembelajaran Interaktif</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }

    .header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 1rem 0;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
    }

    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 2rem;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1.8rem;
      font-weight: bold;
      color: #4a5568;
    }

    .logo img {
      width: 50px;
      height: 50px;
      border-radius: 50%;
    }

    .nav-menu {
      display: flex;
      gap: 2rem;
      list-style: none;
    }

    .nav-menu li a {
      text-decoration: none;
      color: #4a5568;
      font-weight: 500;
      transition: color 0.3s ease;
      cursor: pointer;
    }

    .nav-menu li a:hover {
      color: #667eea;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .hero {
      text-align: center;
      padding: 3rem 0;
      color: white;
    }

    .hero h1 {
      font-size: 8rem;
      margin-bottom: 1rem;
      text-shadow: 4px 4px 8px rgba(0, 0, 0, 0.3);
    }

    .hero p {
      font-size: 1.2rem;
      margin-bottom: 2rem;
      opacity: 0.9;
    }

    .subjects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      margin: 3rem 0;
    }

    .subject-card {
      background: white;
      border-radius: 15px;
      padding: 2rem;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }

    .subject-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
    }

    .subject-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      display: block;
    }

    .subject-card h3 {
      color: #4a5568;
      margin-bottom: 1rem;
      font-size: 1.5rem;
    }

    .subject-content {
      display: none;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 2px solid #e2e8f0;
    }

    .subject-content.active {
      display: block;
    }

    .topic-list {
      list-style: none;
      margin: 1rem 0;
    }

    .topic-list li {
      padding: 0.5rem 0;
      border-bottom: 1px solid #f7fafc;
      color: #666;
    }

    .topic-list li:hover {
      color: #667eea;
      cursor: pointer;
    }

    .ai-chat-section {
      background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
      border-radius: 25px;
      padding: 0;
      margin: 3rem 0;
      box-shadow: 0 20px 60px rgba(102, 126, 234, 0.15);
      border: 1px solid rgba(102, 126, 234, 0.1);
      overflow: hidden;
      position: relative;
    }

    .ai-chat-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea, #764ba2, #f093fb, #f5576c);
      background-size: 400% 400%;
      animation: gradientShift 8s ease infinite;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .chat-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 2.5rem 2rem;
      display: flex;
      align-items: center;
      gap: 1.5rem;
      margin: 0;
      position: relative;
      overflow: hidden;
    }

    .chat-header::after {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 200px;
      height: 200px;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      transform: translate(50px, -50px);
    }

    .chat-header img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      border: 4px solid rgba(255, 255, 255, 0.3);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      transition: transform 0.3s ease;
    }

    .chat-header img:hover {
      transform: scale(1.1) rotate(5deg);
    }

    .chat-header-text h2 {
      margin: 0;
      font-size: 2rem;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      background: linear-gradient(45deg, #fff, #e2e8f0);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .chat-header-text p {
      margin: 0.5rem 0 0 0;
      opacity: 0.9;
      font-size: 1.1rem;
    }

    .chat-container {
      padding: 2rem;
    }

    .prompt-box {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      position: relative;
    }

    .input-wrapper {
      flex: 1;
      position: relative;
    }

    .prompt-box input {
      width: 100%;
      padding: 1.2rem 1.5rem;
      border: 2px solid #e2e8f0;
      border-radius: 20px;
      font-size: 1.1rem;
      outline: none;
      transition: all 0.3s ease;
      background: linear-gradient(145deg, #ffffff, #f8fafc);
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.02);
    }

    .prompt-box input:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1), inset 0 2px 4px rgba(0, 0, 0, 0.02);
      transform: translateY(-2px);
    }

    .prompt-box input::placeholder {
      color: #a0aec0;
      font-style: italic;
    }

    .prompt-box button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 1.2rem 2.5rem;
      border-radius: 20px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
      position: relative;
      overflow: hidden;
    }

    .prompt-box button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .prompt-box button:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
    }

    .prompt-box button:hover::before {
      left: 100%;
    }

    .prompt-box button:active {
      transform: translateY(-1px);
    }

    .output {
      background: linear-gradient(145deg, #f7fafc, #edf2f7);
      border-radius: 20px;
      padding: 2rem;
      min-height: 120px;
      border: 1px solid rgba(226, 232, 240, 0.5);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.7;
      font-size: 1rem;
      box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.05);
      position: relative;
      overflow-y: auto;
      max-height: 400px;
    }

    .output::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #667eea, #764ba2);
      border-radius: 20px 20px 0 0;
    }

    .ai-status {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
      padding: 0.8rem 1.2rem;
      background: linear-gradient(135deg, #48bb78, #38a169);
      color: white;
      border-radius: 15px;
      font-size: 0.9rem;
      font-weight: 500;
      box-shadow: 0 4px 15px rgba(72, 187, 120, 0.3);
    }

    .ai-status::before {
      content: 'üü¢';
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .quick-questions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .quick-question {
      background: linear-gradient(135deg, #e2e8f0, #cbd5e0);
      border: none;
      border-radius: 15px;
      padding: 1rem;
      font-size: 0.9rem;
      color: #2d3748;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    .quick-question:hover {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
    }

    .footer {
      background: rgba(0, 0, 0, 0.8);
      color: white;
      text-align: center;
      padding: 2rem;
      margin-top: 3rem;
    }

    .developer-info {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      padding: 1rem;
      margin-top: 1rem;
      backdrop-filter: blur(5px);
    }

    @media (max-width: 768px) {
      .nav-menu {
        display: none;
      }
      
      .hero h1 {
        font-size: 2rem;
      }
      
      .subjects-grid {
        grid-template-columns: 1fr;
      }
      
      .prompt-box {
        flex-direction: column;
      }
    }
  </style>
</head>

<body>
  <header class="header">
    <div class="nav-container">
      <div class="logo">
        <img src="https://png.pngtree.com/png-vector/20201224/ourlarge/pngtree-future-intelligent-technology-robot-ai-png-image_2588803.jpg" alt="nursAI Logo">
        <span>nursAI</span>
      </div>
      <ul class="nav-menu">
        <li><a onclick="scrollToSection('hero')">Beranda</a></li>
        <li><a onclick="scrollToSection('subjects')">Mata Pelajaran</a></li>
        <li><a onclick="scrollToSection('ai-chat')">Asisten AI</a></li>
        <li><a onclick="scrollToSection('about')">Tentang</a></li>
      </ul>
    </div>
  </header>

  <main>
    <section id="hero" class="hero">
      <div class="container">
        <h1>üéì nursAI</h1>
        <p>Belajar dengan bantuan kecerdasan buatan yang siap membantu kapan saja!</p>
      </div>
    </section>

    <section id="subjects" class="container">
      <div class="subjects-grid">
        <!-- Seni Musik -->
        <div class="subject-card" onclick="toggleSubject('musik')">
          <span class="subject-icon">üéµ</span>
          <h3>Seni Musik</h3>
          <p>Pelajari dasar-dasar teori musik, instrumen, dan apresiasi musik</p>
          
          <div id="musik" class="subject-content">
            <h4>üìö Materi Pembelajaran:</h4>
            <ul class="topic-list">
            <div class="quick-questions">
               <button class="quick-question" onclick="askQuickQuestion('Unsur-unsur Musik')">
                Unsur-unsur Musik
               </button>
               <button class="quick-question" onclick="askQuickQuestion('Jenis-jenis Musik')">
                Jenis - Jenis Musik
               </button>
               <button class="quick-question" onclick="askQuickQuestion('Pergelaran Musik')">
                Pagelaran Musik
               </button>
               <button class="quick-question" onclick="askQuickQuestion('Apresiasi Musik')">
                Apresiasi Musik
               </button>
               <button class="quick-question" onclick="askQuickQuestion('Analisis Musik:')">
                Analisis Musik
               </button>
               <button class="quick-question" onclick="askQuickQuestion('Kreasi Musik')">
                Kreasi Musik
            </ul>
            <p><strong>üí° Tips:</strong> Musik adalah bahasa universal. Mulai dengan mendengarkan berbagai genre musik untuk mengembangkan apresiasi!</p>
          </div>
        </div>

        <!-- Informatika -->
        <div class="subject-card" onclick="toggleSubject('informatika')">
          <span class="subject-icon">üíª</span>
          <h3>Informatika</h3>
          <p>Pahami teknologi informasi, pemrograman, dan komputasi</p>
          
          <div id="informatika" class="subject-content">
            <h4>üìö Materi Pembelajaran:</h4>
            <ul class="topic-list">
              <div class="quick-questions">
               <button class="quick-question" onclick="askQuickQuestion('Berfikir Komputasional')">
                 berfikir komputasional 
               </button>
               <button class="quick-question" onclick="askQuickQuestion('Teknologi Informasi dan Komunikasi')">
                Teknologi Informasi dan Komunikasi
               </button>
               <button class="quick-question" onclick="askQuickQuestion('Sistem Komputer')">
                Sistem Komputer
               </button>
               <button class="quick-question" onclick="askQuickQuestion('Jaringan Komputer dan Internet')">
                Jaringan Komputer dan Internet
               </button>
               <button class="quick-question" onclick="askQuickQuestion('Analisis Data')">
                Analisis Data
               </button>
               <button class="quick-question" onclick="askQuickQuestion('Algoritma dan Pemrograman')">
                Algoritma dan Pemrograman
                <button class="quick-question" onclick="askQuickQuestion('Dampak Sosial Informatika')">
                Dampak Sosial Informatika
                <button class="quick-question" onclick="askQuickQuestion('Praktik Lintas Bidang Informatika')">
                  Praktik Lintas Bidang Informatika  
              </ul>
            <p><strong>üí° Tips:</strong> Informatika bukan hanya tentang coding! Ini tentang pemecahan masalah dan berpikir logis.</p>
          </div>
        </div>

        <!-- Bahasa Sunda -->
        <div class="subject-card" onclick="toggleSubject('sunda')">
          <span class="subject-icon">üèõÔ∏è</span>
          <h3>Bahasa Sunda</h3>
          <p>Lestarikan budaya dengan mempelajari bahasa dan tradisi Sunda</p>
          
          <div id="sunda" class="subject-content">
            <h4>üìö Materi Pembelajaran:</h4>
            <ul class="topic-list">
             <div class="quick-questions">
              <button class="quick-question" onclick="askQuickQuestion('Nyukcruk Sajarah Lembur')">
                Nyukcruk Sajarah Lembur
              </button>
              <button class="quick-question" onclick="askQuickQuestion('Nulis Aksara Sunda')">
               Nulis Aksara Sunda
              </button>
              <button class="quick-question" onclick="askQuickQuestion('Ngolah Pangalaman Batin Jadi sajak')">
                Ngolah Pangalaman Batin jadi sajak
              </button>
              <button class="quick-question" onclick="askQuickQuestion('Nulis Aksara Sunda')">
               Nulis Aksara Sunda
              </button>
              <button class="quick-question" onclick="askQuickQuestion('CARIKAN SAYA APAPUN')">
                CARIKAN SAYA APAPUN
              </button>
              <button class="quick-question" onclick="askQuickQuestion('BELAJAR BARENG PAK EGI?')">
                BELAJAR BARENG PAK EGI?'
            </ul>
            <p><strong>üí° Pepeling:</strong> "Silih Asah, Silih Asih, Silih Asuh" - Mari saling belajar, sayang, dan membimbing dalam melestarikan budaya Sunda!</p>
          </div>
        </div>
      </div>
    </section>

    <section id="ai-chat" class="ai-chat-section">
      <div class="chat-header">
        <img src="https://png.pngtree.com/png-vector/20201224/ourlarge/pngtree-future-intelligent-technology-robot-ai-png-image_2588803.jpg" alt="nursAI Assistant">
        <div class="chat-header-text">
          <h2>nursAI Assistant</h2>
          <p>‚ú® AI pembelajaran pintar yang siap membantu anda belajar</p>
        </div>
      </div>
      
      <div class="chat-container">
        <div class="ai-status">
          Siap membantu anda
        </div>
        
        <form>
          <div class="prompt-box">
            <div class="input-wrapper">
              <input name="prompt" placeholder="üí≠ Tanyakan Apa saja" type="text" value="">
            </div>
            <button type="submit">üöÄ Tanya nursAI</button>
          </div>
        </form>
        
        <div class="output">
          <div style="text-align: center; padding: 1rem;">
            <div style="font-size: 3rem; margin-bottom: 1rem;">ü§ñ</div>
            <h3 style="color: #667eea; margin-bottom: 1rem;">Selamat datang di nursAI!</h3>
            <p style="color: #666; margin-bottom: 1.5rem;">Saya adalah asisten AI yang siap membantu Anda belajar </strong> Mari mulai pembelajaran yang menyenangkan! <strong> </p>
             
            <div class="quick-questions">
              <button class="quick-question" onclick="askQuickQuestion('MENGAPA HARUS BELAJAR SENI MUSIK')">
                üéµ MENGAPA HARUS BELAJAR SENI MUSIK
              </button>
              <button class="quick-question" onclick="askQuickQuestion('MENGAPA HARUS BELAJAR INFORMATIKA')">
                üíª 'MENGAPA HARUS BELAJAR INFORMATIKA?
              </button>
              <button class="quick-question" onclick="askQuickQuestion('MENGAPA HARUS BELAJAR BAHASA SUNDA?')">
                üìù MENGAPA HARUS BELAJAR BAHASA SUNDA?
              </button>
              <button class="quick-question" onclick="askQuickQuestion('SIAPAKAH NURSAI')">
                üé≠ SIAPAKAH NURSAI
              </button>
              <button class="quick-question" onclick="askQuickQuestion('CARIKAN SAYA APAPUN')">
                üîß CARIKAN SAYA APAPUN
              </button>
              <button class="quick-question" onclick="askQuickQuestion('BELAJAR BARENG PAK EGI?')">
                üèõÔ∏è BELAJAR BARENG PAK EGI
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
  <footer id="about" class="footer">
    <div class="container">
      <h3>üåü Tentang nursAI</h3>
      <p>Platform pembelajaran interaktif yang menggabungkan teknologi AI dengan materi edukatif</p>
      
      <div class="developer-info">
        <h4>üë®‚Äçüíª Dikembangkan oleh</h4>
        <p><strong>EGIE NURSA</strong></p>
        
      </div>
      
      <div style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.3);">
        <p>&copy; 2025 EGIE NURSA.</p>
      </div>
    </div>
  </footer>

  <script type="module">
    import { GoogleGenerativeAI, HarmBlockThreshold, HarmCategory } from "https://esm.sh/@google/generative-ai@0.21.0";
    
    // üîë Ganti dengan API Key Gemini Anda
    const API_KEY = 'AIzaSyAyE0oDQKG-Yq5QdjEN34HvlA-eCg053gc'; // ‚ö†Ô∏è Ganti dengan API key yang valid!
    
    let genAI, model, chat;
    
    // --- localStorage Functions ---
    const CHAT_HISTORY_KEY = 'nursAI_chat_history';

    function saveChatHistory(history) {
      localStorage.setItem(CHAT_HISTORY_KEY, JSON.stringify(history));
    }

    function loadChatHistory() {
      const historyString = localStorage.getItem(CHAT_HISTORY_KEY);
      return historyString ? JSON.parse(historyString) : [];
    }
    // --- End localStorage Functions ---
    // Initialize Gemini AI
    try {
      genAI = new GoogleGenerativeAI(API_KEY);
      model = genAI.getGenerativeModel({
        model: "gemini-2.0-flash",
        safetySettings: [
          {
            category: HarmCategory.HARM_CATEGORY_HARASSMENT,
            threshold: HarmBlockThreshold.BLOCK_ONLY_HIGH,
          },
        ],
      });
      
      chat = model.startChat({
        history: [
          {
            role: "user",
            parts: [{ text: "Kamu adalah nursAI, asisten pembelajaran dikembangkan oleh pak Egie Nursa untuk membatu anda belajar dengan menyenangkan" }]
          },
          {
            role: "model",
            parts: [{ text: "Halo! Saya nursAI ü§ñ, asisten pembelajaran Pak Egie Nursa üòä" }]
          }
        ],
        generationConfig: {
          maxOutputTokens: 100000
        }
      });
    } catch (error) {
      console.error('Error initializing Gemini AI:', error);
      // Display initialization error in output div if possible
      const output = document.querySelector('.output');
      if (output) {
         output.innerHTML = `
           <div style="text-align: center; padding: 30px; background: #fed7d7; border: 2px solid #fc8181; border-radius: 15px; color: #c53030;">
             <div style="font-size: 2rem; margin-bottom: 10px;">üòî</div>
             <h3 style="margin-bottom: 10px;">Gagal Menginisialisasi AI</h3>
             <p style="font-size: 0.95em;">${error.message || 'Periksa koneksi internet atau API Key.'}</p>
           </div>
         `;
      }
    }

    // Function to format and display a message
    function displayMessage(role, text) {
        const output = document.querySelector('.output');
        const messageElement = document.createElement('div');
        messageElement.style.marginBottom = '15px';
        messageElement.style.padding = '10px 15px';
        messageElement.style.borderRadius = '15px';
        messageElement.style.maxWidth = '90%';
        messageElement.style.lineHeight = '1.6';
        messageElement.style.wordBreak = 'break-word'; // Handle long words

        if (role === 'user') {
            messageElement.style.background = '#e2e8f0';
            messageElement.style.marginLeft = 'auto';
            messageElement.style.textAlign = 'right';
            messageElement.innerHTML = `<strong style="color: #4a5568;">Anda:</strong><br>${text.replace(/\n/g, '<br>')}`;
        } else { // role === 'model'
            messageElement.style.background = 'linear-gradient(135deg, #667eea1a, #764ba21a)'; // light gradient background
            messageElement.style.borderLeft = '4px solid #667eea';
            messageElement.style.marginRight = 'auto';
            messageElement.innerHTML = `<strong style="color: #667eea;">nursAI:</strong><br>${text.replace(/\n/g, '<br>')
                .replace(/\*\*(.*?)\*\*/g, '<strong style="color: #4a5568;">$1</strong>') // Bold
                .replace(/\*(.*?)\*/g, '<em>$1</em>')}`; // Italic
        }
        output.appendChild(messageElement);
        output.scrollTop = output.scrollHeight; // Auto-scroll
    }

    // Display initial chat history on load
    document.addEventListener('DOMContentLoaded', function() {
        const output = document.querySelector('.output');
        output.innerHTML = ''; // Clear initial welcome message
        const history = loadChatHistory();
        // Skip the initial system instruction if present
        const displayHistory = history.filter(msg => msg.role !== 'user' || msg.parts[0].text !== 'Kamu adalah nursAI, asisten pembelajaran dikembangkan oleh pak Egie Nursa untuk membatu anda belajar dengan menyenangkan');

        displayHistory.forEach(msg => {
            if (msg.parts && msg.parts.length > 0 && msg.parts[0].text) {
                displayMessage(msg.role, msg.parts[0].text);
            }
        });

       // Add some interactive effects (existing code)
        const cards = document.querySelectorAll('.subject-card');
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.style.opacity = '1';
              entry.target.style.transform = 'translateY(0)';
            }
          });
        });

        cards.forEach(card => {
          card.style.opacity = '0';
          card.style.transform = 'translateY(20px)';
          card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
          observer.observe(card);
        });

         // Display welcome message if no history
         if (displayHistory.length <= 1) { // Check against default AI welcome message
            output.innerHTML += `
            <div style="text-align: center; padding: 1rem;">
              <div style="font-size: 3rem; margin-bottom: 1rem;">ü§ñ</div>
              <h3 style="color: #667eea; margin-bottom: 1rem;">Selamat datang di nursAI!</h3>
              <p style="color: #666; margin-bottom: 1.5rem;">Saya adalah asisten AI yang siap membantu Anda belajar. Mari mulai pembelajaran yang menyenangkan!</p>
              
              <div class="quick-questions">
                <button class="quick-question" onclick="askQuickQuestion('MENGAPA HARUS BELAJAR SENI MUSIK')">
                  üéµ MENGAPA HARUS BELAJAR SENI MUSIK
                </button>
                <button class="quick-question" onclick="askQuickQuestion('MENGAPA HARUS BELAJAR INFORMATIKA')">
                  üíª MENGAPA HARUS BELAJAR INFORMATIKA?
                </button>
                <button class="quick-question" onclick="askQuickQuestion('MENGAPA HARUS BELAJAR BAHASA SUNDA?')">
                  üìù MENGAPA HARUS BELAJAR BAHASA SUNDA?
                </button>
                 <button class="quick-question" onclick="askQuickQuestion('SIAPAKAH NURSAI')">
                  üé≠ SIAPAKAH NURSAI
                </button>
                <button class="quick-question" onclick="askQuickQuestion('CARIKAN SAYA APAPUN')">
                  üîß CARIKAN SAYA APAPUN
                </button>
                <button class="quick-question" onclick="askQuickQuestion('BELAJAR BARENG PAK EGI?')">
                  üèõÔ∏è BELAJAR BARENG PAK EGI
                </button>
              </div>
            </div>
           `;
         }
    });

    // Toggle subject content (existing function)
    function toggleSubject(subjectId) {
      const content = document.getElementById(subjectId);
      const allContents = document.querySelectorAll('.subject-content');

      // Close all other contents
      allContents.forEach(c => {
        if (c.id !== subjectId) {
          c.classList.remove('active');
        }
      });

      // Toggle current content
      content.classList.toggle('active');
    }

    // Smooth scroll to sections (existing function)
    function scrollToSection(sectionId) {
      document.getElementById(sectionId).scrollIntoView({
        behavior: 'smooth'
      });
    }

    // Make functions global (existing code)
    window.toggleSubject = toggleSubject;
    window.scrollToSection = scrollToSection;

    // Quick question function (existing code)
    window.askQuickQuestion = function(question) {
      const promptInput = document.querySelector('input[name="prompt"]');
      promptInput.value = question;

      // Trigger form submission
      document.querySelector('form').dispatchEvent(new Event('submit'));
    };

    // Real Gemini AI form handling
    document.querySelector('form').onsubmit = async function(ev) {
      ev.preventDefault();
      const output = document.querySelector('.output');
      const promptInput = document.querySelector('input[name="prompt"]');
      const prompt = promptInput.value.trim();

      if (!prompt) {
        // Modern alert styling
        output.innerHTML += `
          <div style="background: linear-gradient(135deg, #fed7d7, #feb2b2); border: 2px solid #fc8181; border-radius: 15px; padding: 15px; text-align: center; margin-bottom: 15px;">
            <p style="color: #c53030; font-weight: 600; font-size: 0.9em;">Silakan masukkan pertanyaan terlebih dahulu!</p>
          </div>
        `;
        output.scrollTop = output.scrollHeight;
        return;
      }

      // Display user message immediately
      displayMessage('user', prompt);

      // Clear input
      promptInput.value = '';

      // Show modern loading state (optional, can display text instead)
      const loadingIndicator = document.createElement('div');
       loadingIndicator.innerHTML = `
        <div style="text-align: center; padding: 10px 0; margin-bottom: 15px;">
          <div style="position: relative; display: inline-block;">
            <div style="width: 30px; height: 30px; border: 3px solid rgba(102, 126, 234, 0.2); border-radius: 50%; border-top: 3px solid #667eea; animation: modernSpin 1s linear infinite;"></div>
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 1rem;">ü§ñ</div>
          </div>
        </div>
        <style>
          @keyframes modernSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        </style>
      `;
      output.appendChild(loadingIndicator);
      output.scrollTop = output.scrollHeight;

      try {
        if (!chat) {
          throw new Error('AI belum diinisialisasi. Pastikan API Key sudah benar.');
        }

        // Add user message to chat history *before* sending
        // chat.history.push({ role: 'user', parts: [{ text: prompt }] }); // This is handled by sendMessage implicitly now

        // Use the existing chat object to send the message
        const result = await chat.sendMessageStream(prompt);

        // Remove loading indicator
        loadingIndicator.remove();

        // Prepare element for AI response
        const aiResponseElement = document.createElement('div');
        aiResponseElement.style.marginBottom = '15px';
        aiResponseElement.style.padding = '10px 15px';
        aiResponseElement.style.borderRadius = '15px';
        aiResponseElement.style.maxWidth = '90%';
        aiResponseElement.style.lineHeight = '1.6';
        aiResponseElement.style.wordBreak = 'break-word';
        aiResponseElement.style.background = 'linear-gradient(135deg, #667eea1a, #764ba21a)';
        aiResponseElement.style.borderLeft = '4px solid #667eea';
        aiResponseElement.style.marginRight = 'auto';
        aiResponseElement.innerHTML = `<strong style="color: #667eea;">nursAI:</strong><br>`;
        const responseTextSpan = document.createElement('span');
        aiResponseElement.appendChild(responseTextSpan);
        output.appendChild(aiResponseElement);
        output.scrollTop = output.scrollHeight;

        let fullResponseText = '';

        // Stream the response with typing effect
        for await (let response of result.stream) {
          const chunkText = response.text();
          fullResponseText += chunkText;
          const formattedText = fullResponseText
            .replace(/\n/g, '<br>')
            .replace(/\*\*(.*?)\*\*/g, '<strong style="color: #4a5568;">$1</strong>') // Bold
            .replace(/\*(.*?)\*/g, '<em>$1</em>'); // Italic

          responseTextSpan.innerHTML = formattedText;

          // Auto scroll to bottom
          output.scrollTop = output.scrollHeight;
        }

        // Add full AI response to chat history after stream is complete
        // The Gemini JS SDK automatically adds the response to chat.history when using chat.sendMessageStream
        // So, we just need to save the history to localStorage
        saveChatHistory(chat.history);

        // Add feedback buttons after response
        aiResponseElement.innerHTML += `
          <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e2e8f0; display: flex; gap: 10px; align-items: center;">
            <span style="color: #666; font-size: 0.9em;">Apakah jawaban ini membantu?</span>
            <button onclick="giveFeedback(this, 'üëç')" style="background: linear-gradient(135deg, #48bb78, #38a169); color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.8em;">üëç Ya</button>
            <button onclick="giveFeedback(this, 'üëé')" style="background: linear-gradient(135deg, #f56565, #e53e3e); color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.8em;">üëé Tidak</button>
          </div>
        `;


      } catch (error) {
        console.error('Error during sendMessageStream:', error);
         // Remove loading indicator if it's still there
        if (loadingIndicator && loadingIndicator.parentElement) {
            loadingIndicator.remove();
        }
        output.innerHTML += `
          <div style="background: linear-gradient(135deg, #fed7d7, #feb2b2); border: 2px solid #fc8181; border-radius: 15px; padding: 20px; color: #c53030; margin-bottom: 15px;">
            <div style="font-size: 1.5rem; margin-bottom: 10px;">üòî</div>
            <h3 style="margin-bottom: 10px;">Maaf, terjadi kesalahan</h3>
            <p style="font-size: 0.95em; margin-bottom: 15px;">${error.message || 'Terjadi kesalahan saat berkomunikasi dengan AI.'}</p>

            <div style="background: rgba(255, 255, 255, 0.8); padding: 10px; border-radius: 8px; margin-top: 15px; color: #744210; text-align: left; font-size: 0.9em;">
              <strong>üõ†Ô∏è Solusi yang bisa dicoba:</strong><br>
              <ul style="margin-top: 5px; padding-left: 20px;">
                  <li>Periksa koneksi internet.</li>
                  <li>Pastikan API Key Gemini benar.</li>
                  <li>Coba pertanyaan lain.</li>
                  <li>Refresh halaman.</li>
              </ul>
            </div>
          </div>
        `;
        output.scrollTop = output.scrollHeight;
         // Optionally, try to save history up to this point if the error isn't fatal
        if (chat && chat.history) {
             saveChatHistory(chat.history);
        }
      }
    };

    // Feedback function
    window.giveFeedback = function(buttonElement, type) {
      const feedbackContainer = buttonElement.parentElement;
      feedbackContainer.innerHTML = `
        <div style="color: #48bb78; font-size: 0.9em;">
          ${type === 'üëç' ? '‚úÖ Terima kasih atas feedback positifnya!' : 'üìù Terima kasih, kami akan terus berkembang!'}
        </div>
      `;
    };

    // Add some interactive effects
    document.addEventListener('DOMContentLoaded', function() {
      // Animate cards on scroll
      const cards = document.querySelectorAll('.subject-card');
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
          }
        });
      });

      cards.forEach(card => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(card);
      });
    });
  </script>
</body>
</html>